\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSTP/\+QSTP/root.h File Reference}
\hypertarget{root_8h}{}\label{root_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSTP/QSTP/root.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSTP/QSTP/root.h}}


The QSTP Root Security server.  


{\ttfamily \#include "{}common.\+h"{}}\newline
{\ttfamily \#include "{}qstp.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} bool \mbox{\hyperlink{root_8h_aa122d984a73a113732d757055bf54a3f}{qstp\+\_\+root\+\_\+certificate\+\_\+export}} (const \mbox{\hyperlink{structqstp__root__certificate}{qstp\+\_\+root\+\_\+certificate}} \texorpdfstring{$\ast$}{*}root, const char \texorpdfstring{$\ast$}{*}fpath)
\begin{DoxyCompactList}\small\item\em Export the root certificate to a file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} void \mbox{\hyperlink{root_8h_a7441644a1122d665aecd10a14ea10819}{qstp\+\_\+root\+\_\+key\+\_\+generate}} (\mbox{\hyperlink{structqstp__root__signature__key}{qstp\+\_\+root\+\_\+signature\+\_\+key}} \texorpdfstring{$\ast$}{*}kset, const char issuer\mbox{[}\mbox{\hyperlink{qstp_8h_a3d0871de23850d6d73eacbf9494efd76}{QSTP\+\_\+\+CERTIFICATE\+\_\+\+ISSUER\+\_\+\+SIZE}}\mbox{]}, uint32\+\_\+t exp)
\begin{DoxyCompactList}\small\item\em Generate a new root key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} void \mbox{\hyperlink{root_8h_a8db81dabd08dc475bc2787062a877376}{qstp\+\_\+root\+\_\+certificate\+\_\+print}} (const \mbox{\hyperlink{structqstp__root__certificate}{qstp\+\_\+root\+\_\+certificate}} \texorpdfstring{$\ast$}{*}root)
\begin{DoxyCompactList}\small\item\em Print the root certificate. \end{DoxyCompactList}\item 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} void \mbox{\hyperlink{root_8h_aa4d1b8dcde87b44fca5cca3af8a3ced6}{qstp\+\_\+root\+\_\+server\+\_\+certificate\+\_\+print}} (const \mbox{\hyperlink{structqstp__server__certificate}{qstp\+\_\+server\+\_\+certificate}} \texorpdfstring{$\ast$}{*}cert)
\begin{DoxyCompactList}\small\item\em Print a server certificate. \end{DoxyCompactList}\item 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} \mbox{\hyperlink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} \mbox{\hyperlink{root_8h_a182305164bb5879756b127d544272467}{qstp\+\_\+root\+\_\+certificate\+\_\+revoke}} (const uint8\+\_\+t \texorpdfstring{$\ast$}{*}rootkey, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}serial, const qsc\+\_\+ipinfo\+\_\+ipv4\+\_\+address \texorpdfstring{$\ast$}{*}address)
\begin{DoxyCompactList}\small\item\em Send a certificate revocation request to a client. \end{DoxyCompactList}\item 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} bool \mbox{\hyperlink{root_8h_a4fffee1943448704035bc705308e7a90}{qstp\+\_\+root\+\_\+sign\+\_\+certificate}} (const char \texorpdfstring{$\ast$}{*}fpath, const \mbox{\hyperlink{structqstp__root__certificate}{qstp\+\_\+root\+\_\+certificate}} \texorpdfstring{$\ast$}{*}root, const uint8\+\_\+t \texorpdfstring{$\ast$}{*}rootkey)
\begin{DoxyCompactList}\small\item\em Sign a child certificate. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The QSTP Root Security server. 

This header defines functions used by the QSTP Root Security server, which serves as the trust anchor within the Quantum Secure Tunneling Protocol (QSTP). The root server is responsible for managing root certificates and keys, including exporting certificates to persistent storage, generating new root signing keys, printing certificate details, revoking certificates, and signing child certificates. These operations are fundamental for establishing trust between the QSTP root, servers, and clients.

\begin{DoxyNote}{Note}
These functions are internal and non-\/exportable. 
\end{DoxyNote}


\doxysubsection{Function Documentation}
\Hypertarget{root_8h_aa122d984a73a113732d757055bf54a3f}\index{root.h@{root.h}!qstp\_root\_certificate\_export@{qstp\_root\_certificate\_export}}
\index{qstp\_root\_certificate\_export@{qstp\_root\_certificate\_export}!root.h@{root.h}}
\doxysubsubsection{\texorpdfstring{qstp\_root\_certificate\_export()}{qstp\_root\_certificate\_export()}}
{\footnotesize\ttfamily \label{root_8h_aa122d984a73a113732d757055bf54a3f} 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} bool qstp\+\_\+root\+\_\+certificate\+\_\+export (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structqstp__root__certificate}{qstp\+\_\+root\+\_\+certificate}} \texorpdfstring{$\ast$}{*}}]{root}{, }\item[{const char \texorpdfstring{$\ast$}{*}}]{fpath}{}\end{DoxyParamCaption})}



Export the root certificate to a file. 

This function writes the given QSTP root certificate to a file at the specified file path. The exported certificate is used for distribution and for verifying the signatures of child certificates in the QSTP system.


\begin{DoxyParams}{Parameters}
{\em root} & \mbox{[}const\mbox{]} A pointer to the QSTP root certificate to be exported. \\
\hline
{\em fpath} & The output file path where the root certificate will be saved.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true if the export operation succeeds; otherwise, returns false. 
\end{DoxyReturn}
\Hypertarget{root_8h_a8db81dabd08dc475bc2787062a877376}\index{root.h@{root.h}!qstp\_root\_certificate\_print@{qstp\_root\_certificate\_print}}
\index{qstp\_root\_certificate\_print@{qstp\_root\_certificate\_print}!root.h@{root.h}}
\doxysubsubsection{\texorpdfstring{qstp\_root\_certificate\_print()}{qstp\_root\_certificate\_print()}}
{\footnotesize\ttfamily \label{root_8h_a8db81dabd08dc475bc2787062a877376} 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} void qstp\+\_\+root\+\_\+certificate\+\_\+print (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structqstp__root__certificate}{qstp\+\_\+root\+\_\+certificate}} \texorpdfstring{$\ast$}{*}}]{root}{}\end{DoxyParamCaption})}



Print the root certificate. 

This function prints the details of the QSTP root certificate to the standard output or to a designated logging stream. It is typically used for debugging or verification of the root certificate information.


\begin{DoxyParams}{Parameters}
{\em root} & \mbox{[}const\mbox{]} A pointer to the QSTP root certificate. \\
\hline
\end{DoxyParams}
\Hypertarget{root_8h_a182305164bb5879756b127d544272467}\index{root.h@{root.h}!qstp\_root\_certificate\_revoke@{qstp\_root\_certificate\_revoke}}
\index{qstp\_root\_certificate\_revoke@{qstp\_root\_certificate\_revoke}!root.h@{root.h}}
\doxysubsubsection{\texorpdfstring{qstp\_root\_certificate\_revoke()}{qstp\_root\_certificate\_revoke()}}
{\footnotesize\ttfamily \label{root_8h_a182305164bb5879756b127d544272467} 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} \mbox{\hyperlink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} qstp\+\_\+root\+\_\+certificate\+\_\+revoke (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{rootkey}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{serial}{, }\item[{const qsc\+\_\+ipinfo\+\_\+ipv4\+\_\+address \texorpdfstring{$\ast$}{*}}]{address}{}\end{DoxyParamCaption})}



Send a certificate revocation request to a client. 

This function sends a certificate revocation request to a client, using the provided root signing key and the certificate serial number that identifies the certificate to be revoked. The request is sent to the specified server IPv4 network address.


\begin{DoxyParams}{Parameters}
{\em rootkey} & A pointer to the root signing key. \\
\hline
{\em serial} & A pointer to the certificate serial number that should be revoked. \\
\hline
{\em address} & A pointer to the IPv4 network address of the target server.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} indicating the result of the revocation request. 
\end{DoxyReturn}
\Hypertarget{root_8h_a7441644a1122d665aecd10a14ea10819}\index{root.h@{root.h}!qstp\_root\_key\_generate@{qstp\_root\_key\_generate}}
\index{qstp\_root\_key\_generate@{qstp\_root\_key\_generate}!root.h@{root.h}}
\doxysubsubsection{\texorpdfstring{qstp\_root\_key\_generate()}{qstp\_root\_key\_generate()}}
{\footnotesize\ttfamily \label{root_8h_a7441644a1122d665aecd10a14ea10819} 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} void qstp\+\_\+root\+\_\+key\+\_\+generate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqstp__root__signature__key}{qstp\+\_\+root\+\_\+signature\+\_\+key}} \texorpdfstring{$\ast$}{*}}]{kset}{, }\item[{const char}]{issuer}{\mbox{[}\+QSTP\+\_\+\+CERTIFICATE\+\_\+\+ISSUER\+\_\+\+SIZE\mbox{]}, }\item[{uint32\+\_\+t}]{exp}{}\end{DoxyParamCaption})}



Generate a new root key. 

This function generates a new QSTP root signing key. It populates the provided root signature key structure with a new key, using the specified issuer name and a validity period (in days). The newly generated root key is used to sign certificates for QSTP servers and clients, thus establishing a chain of trust.


\begin{DoxyParams}{Parameters}
{\em kset} & A pointer to the QSTP root signature key structure that will receive the new key. \\
\hline
{\em issuer} & The issuer name to be associated with the new root key. The string length must be equal to {\ttfamily QSTP\+\_\+\+CERTIFICATE\+\_\+\+ISSUER\+\_\+\+SIZE}. \\
\hline
{\em exp} & The number of valid days for the new root key. \\
\hline
\end{DoxyParams}
\Hypertarget{root_8h_aa4d1b8dcde87b44fca5cca3af8a3ced6}\index{root.h@{root.h}!qstp\_root\_server\_certificate\_print@{qstp\_root\_server\_certificate\_print}}
\index{qstp\_root\_server\_certificate\_print@{qstp\_root\_server\_certificate\_print}!root.h@{root.h}}
\doxysubsubsection{\texorpdfstring{qstp\_root\_server\_certificate\_print()}{qstp\_root\_server\_certificate\_print()}}
{\footnotesize\ttfamily \label{root_8h_aa4d1b8dcde87b44fca5cca3af8a3ced6} 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} void qstp\+\_\+root\+\_\+server\+\_\+certificate\+\_\+print (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structqstp__server__certificate}{qstp\+\_\+server\+\_\+certificate}} \texorpdfstring{$\ast$}{*}}]{cert}{}\end{DoxyParamCaption})}



Print a server certificate. 

This function prints the details of a QSTP server certificate, including issuer, serial number, validity period, and cryptographic parameters. It is used for debugging and verifying the server certificate.


\begin{DoxyParams}{Parameters}
{\em cert} & \mbox{[}const\mbox{]} A pointer to the QSTP server certificate. \\
\hline
\end{DoxyParams}
\Hypertarget{root_8h_a4fffee1943448704035bc705308e7a90}\index{root.h@{root.h}!qstp\_root\_sign\_certificate@{qstp\_root\_sign\_certificate}}
\index{qstp\_root\_sign\_certificate@{qstp\_root\_sign\_certificate}!root.h@{root.h}}
\doxysubsubsection{\texorpdfstring{qstp\_root\_sign\_certificate()}{qstp\_root\_sign\_certificate()}}
{\footnotesize\ttfamily \label{root_8h_a4fffee1943448704035bc705308e7a90} 
\mbox{\hyperlink{common_8h_a3f0b9b1611da0c7ec65aff9e0ee782b7}{QSTP\+\_\+\+EXPORT\+\_\+\+API}} bool qstp\+\_\+root\+\_\+sign\+\_\+certificate (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{fpath}{, }\item[{const \mbox{\hyperlink{structqstp__root__certificate}{qstp\+\_\+root\+\_\+certificate}} \texorpdfstring{$\ast$}{*}}]{root}{, }\item[{const uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{rootkey}{}\end{DoxyParamCaption})}



Sign a child certificate. 

This function signs a child certificate using the provided root certificate and root signing key. The signed certificate is then exported to the file specified by the file path. Signing a child certificate attests to its authenticity and establishes its chain of trust from the root.


\begin{DoxyParams}{Parameters}
{\em fpath} & The file path where the signed child certificate will be saved. \\
\hline
{\em root} & A pointer to the QSTP root certificate. \\
\hline
{\em rootkey} & A pointer to the root signing key.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true if the certificate signing is successful; otherwise, returns false. 
\end{DoxyReturn}
