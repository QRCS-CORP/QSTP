<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Secure Tunneling Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSTP/QSTP/root.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qstp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Quantum Secure Tunneling Protocol<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A three-party quantum secure encrypted tunneling protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('root_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">root.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The QSTP Root Security server.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qstp_8h_source.html">qstp.h</a>&quot;</code><br />
</div>
<p><a href="root_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa122d984a73a113732d757055bf54a3f" id="r_aa122d984a73a113732d757055bf54a3f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa122d984a73a113732d757055bf54a3f">qstp_root_certificate_export</a> (const <a class="el" href="structqstp__root__certificate.html">qstp_root_certificate</a> *root, const char *fpath)</td></tr>
<tr class="memdesc:aa122d984a73a113732d757055bf54a3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export the root certificate to a file.  <br /></td></tr>
<tr class="separator:aa122d984a73a113732d757055bf54a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7441644a1122d665aecd10a14ea10819" id="r_a7441644a1122d665aecd10a14ea10819"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7441644a1122d665aecd10a14ea10819">qstp_root_key_generate</a> (<a class="el" href="structqstp__root__signature__key.html">qstp_root_signature_key</a> *kset, const char issuer[<a class="el" href="qstp_8h.html#a3d0871de23850d6d73eacbf9494efd76">QSTP_CERTIFICATE_ISSUER_SIZE</a>], uint32_t exp)</td></tr>
<tr class="memdesc:a7441644a1122d665aecd10a14ea10819"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a new root key.  <br /></td></tr>
<tr class="separator:a7441644a1122d665aecd10a14ea10819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8db81dabd08dc475bc2787062a877376" id="r_a8db81dabd08dc475bc2787062a877376"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8db81dabd08dc475bc2787062a877376">qstp_root_certificate_print</a> (const <a class="el" href="structqstp__root__certificate.html">qstp_root_certificate</a> *root)</td></tr>
<tr class="memdesc:a8db81dabd08dc475bc2787062a877376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the root certificate.  <br /></td></tr>
<tr class="separator:a8db81dabd08dc475bc2787062a877376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4d1b8dcde87b44fca5cca3af8a3ced6" id="r_aa4d1b8dcde87b44fca5cca3af8a3ced6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa4d1b8dcde87b44fca5cca3af8a3ced6">qstp_root_server_certificate_print</a> (const <a class="el" href="structqstp__server__certificate.html">qstp_server_certificate</a> *cert)</td></tr>
<tr class="memdesc:aa4d1b8dcde87b44fca5cca3af8a3ced6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a server certificate.  <br /></td></tr>
<tr class="separator:aa4d1b8dcde87b44fca5cca3af8a3ced6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182305164bb5879756b127d544272467" id="r_a182305164bb5879756b127d544272467"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> <a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853">qstp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a182305164bb5879756b127d544272467">qstp_root_certificate_revoke</a> (const uint8_t *rootkey, const uint8_t *serial, const qsc_ipinfo_ipv4_address *address)</td></tr>
<tr class="memdesc:a182305164bb5879756b127d544272467"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a certificate revocation request to a client.  <br /></td></tr>
<tr class="separator:a182305164bb5879756b127d544272467"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fffee1943448704035bc705308e7a90" id="r_a4fffee1943448704035bc705308e7a90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4fffee1943448704035bc705308e7a90">qstp_root_sign_certificate</a> (const char *fpath, const <a class="el" href="structqstp__root__certificate.html">qstp_root_certificate</a> *root, const uint8_t *rootkey)</td></tr>
<tr class="memdesc:a4fffee1943448704035bc705308e7a90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sign a child certificate.  <br /></td></tr>
<tr class="separator:a4fffee1943448704035bc705308e7a90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The QSTP Root Security server. </p>
<p>This header defines functions used by the QSTP Root Security server, which serves as the trust anchor within the Quantum Secure Tunneling Protocol (QSTP). The root server is responsible for managing root certificates and keys, including exporting certificates to persistent storage, generating new root signing keys, printing certificate details, revoking certificates, and signing child certificates. These operations are fundamental for establishing trust between the QSTP root, servers, and clients.</p>
<dl class="section note"><dt>Note</dt><dd>These functions are internal and non-exportable. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa122d984a73a113732d757055bf54a3f" name="aa122d984a73a113732d757055bf54a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa122d984a73a113732d757055bf54a3f">&#9670;&#160;</a></span>qstp_root_certificate_export()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> bool qstp_root_certificate_export </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structqstp__root__certificate.html">qstp_root_certificate</a> *</td>          <td class="paramname"><span class="paramname"><em>root</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fpath</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Export the root certificate to a file. </p>
<p>This function writes the given QSTP root certificate to a file at the specified file path. The exported certificate is used for distribution and for verifying the signatures of child certificates in the QSTP system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">root</td><td>[const] A pointer to the QSTP root certificate to be exported. </td></tr>
    <tr><td class="paramname">fpath</td><td>The output file path where the root certificate will be saved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the export operation succeeds; otherwise, returns false. </dd></dl>

</div>
</div>
<a id="a8db81dabd08dc475bc2787062a877376" name="a8db81dabd08dc475bc2787062a877376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8db81dabd08dc475bc2787062a877376">&#9670;&#160;</a></span>qstp_root_certificate_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> void qstp_root_certificate_print </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structqstp__root__certificate.html">qstp_root_certificate</a> *</td>          <td class="paramname"><span class="paramname"><em>root</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the root certificate. </p>
<p>This function prints the details of the QSTP root certificate to the standard output or to a designated logging stream. It is typically used for debugging or verification of the root certificate information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">root</td><td>[const] A pointer to the QSTP root certificate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a182305164bb5879756b127d544272467" name="a182305164bb5879756b127d544272467"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a182305164bb5879756b127d544272467">&#9670;&#160;</a></span>qstp_root_certificate_revoke()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> <a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853">qstp_errors</a> qstp_root_certificate_revoke </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>rootkey</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>serial</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const qsc_ipinfo_ipv4_address *</td>          <td class="paramname"><span class="paramname"><em>address</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a certificate revocation request to a client. </p>
<p>This function sends a certificate revocation request to a client, using the provided root signing key and the certificate serial number that identifies the certificate to be revoked. The request is sent to the specified server IPv4 network address.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rootkey</td><td>A pointer to the root signing key. </td></tr>
    <tr><td class="paramname">serial</td><td>A pointer to the certificate serial number that should be revoked. </td></tr>
    <tr><td class="paramname">address</td><td>A pointer to the IPv4 network address of the target server.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853" title="The QSTP error values.">qstp_errors</a></code> indicating the result of the revocation request. </dd></dl>

</div>
</div>
<a id="a7441644a1122d665aecd10a14ea10819" name="a7441644a1122d665aecd10a14ea10819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7441644a1122d665aecd10a14ea10819">&#9670;&#160;</a></span>qstp_root_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> void qstp_root_key_generate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqstp__root__signature__key.html">qstp_root_signature_key</a> *</td>          <td class="paramname"><span class="paramname"><em>kset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char</td>          <td class="paramname"><span class="paramname"><em>issuer</em></span>[QSTP_CERTIFICATE_ISSUER_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>exp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a new root key. </p>
<p>This function generates a new QSTP root signing key. It populates the provided root signature key structure with a new key, using the specified issuer name and a validity period (in days). The newly generated root key is used to sign certificates for QSTP servers and clients, thus establishing a chain of trust.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kset</td><td>A pointer to the QSTP root signature key structure that will receive the new key. </td></tr>
    <tr><td class="paramname">issuer</td><td>The issuer name to be associated with the new root key. The string length must be equal to <code>QSTP_CERTIFICATE_ISSUER_SIZE</code>. </td></tr>
    <tr><td class="paramname">exp</td><td>The number of valid days for the new root key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa4d1b8dcde87b44fca5cca3af8a3ced6" name="aa4d1b8dcde87b44fca5cca3af8a3ced6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4d1b8dcde87b44fca5cca3af8a3ced6">&#9670;&#160;</a></span>qstp_root_server_certificate_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> void qstp_root_server_certificate_print </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structqstp__server__certificate.html">qstp_server_certificate</a> *</td>          <td class="paramname"><span class="paramname"><em>cert</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a server certificate. </p>
<p>This function prints the details of a QSTP server certificate, including issuer, serial number, validity period, and cryptographic parameters. It is used for debugging and verifying the server certificate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert</td><td>[const] A pointer to the QSTP server certificate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4fffee1943448704035bc705308e7a90" name="a4fffee1943448704035bc705308e7a90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fffee1943448704035bc705308e7a90">&#9670;&#160;</a></span>qstp_root_sign_certificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a3f0b9b1611da0c7ec65aff9e0ee782b7">QSTP_EXPORT_API</a> bool qstp_root_sign_certificate </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fpath</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structqstp__root__certificate.html">qstp_root_certificate</a> *</td>          <td class="paramname"><span class="paramname"><em>root</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>rootkey</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sign a child certificate. </p>
<p>This function signs a child certificate using the provided root certificate and root signing key. The signed certificate is then exported to the file specified by the file path. Signing a child certificate attests to its authenticity and establishes its chain of trust from the root.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fpath</td><td>The file path where the signed child certificate will be saved. </td></tr>
    <tr><td class="paramname">root</td><td>A pointer to the QSTP root certificate. </td></tr>
    <tr><td class="paramname">rootkey</td><td>A pointer to the root signing key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if the certificate signing is successful; otherwise, returns false. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5a7a8ad7fd52b2a05665dc92ffe673dd.html">QSTP</a></li><li class="navelem"><a class="el" href="root_8h.html">root.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
