\doxysection{C\+:/\+Users/stepp/\+Documents/\+Visual Studio 2022/\+Projects/\+C/\+QSTP/\+QSTP/kex.h File Reference}
\hypertarget{kex_8h}{}\label{kex_8h}\index{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSTP/QSTP/kex.h@{C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSTP/QSTP/kex.h}}


QSTP key exchange functions.  


{\ttfamily \#include "{}common.\+h"{}}\newline
{\ttfamily \#include "{}../\+QSTP/qstp.\+h"{}}\newline
\doxysubsubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structqstp__kex__client__state}{qstp\+\_\+kex\+\_\+client\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The QSTP client state structure. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structqstp__kex__server__state}{qstp\+\_\+kex\+\_\+server\+\_\+state}}
\begin{DoxyCompactList}\small\item\em The QSTP server state structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{kex_8h_a3f04acf418e78533b0e81fce4f38d99a}\label{kex_8h_a3f04acf418e78533b0e81fce4f38d99a} 
typedef struct qstp\+\_\+kex\+\_\+client\+\_\+state {\bfseries qstp\+\_\+kex\+\_\+client\+\_\+state}
\item 
\Hypertarget{kex_8h_a628f08680bc40241d868cee8176bcb4b}\label{kex_8h_a628f08680bc40241d868cee8176bcb4b} 
typedef struct qstp\+\_\+kex\+\_\+server\+\_\+state {\bfseries qstp\+\_\+kex\+\_\+server\+\_\+state}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} \mbox{\hyperlink{kex_8h_a4c40b6b1bf97b19d057c5ce543dcc8e7}{qstp\+\_\+kex\+\_\+server\+\_\+key\+\_\+exchange}} (\mbox{\hyperlink{structqstp__kex__server__state}{qstp\+\_\+kex\+\_\+server\+\_\+state}} \texorpdfstring{$\ast$}{*}kss, \mbox{\hyperlink{structqstp__connection__state}{qstp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Run the network server version of the key exchange. \end{DoxyCompactList}\item 
\mbox{\hyperlink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} \mbox{\hyperlink{kex_8h_a21e7cf4bd346c4d534078be1757bde51}{qstp\+\_\+kex\+\_\+client\+\_\+key\+\_\+exchange}} (\mbox{\hyperlink{structqstp__kex__client__state}{qstp\+\_\+kex\+\_\+client\+\_\+state}} \texorpdfstring{$\ast$}{*}kcs, \mbox{\hyperlink{structqstp__connection__state}{qstp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}cns)
\begin{DoxyCompactList}\small\item\em Run the network client version of the key exchange. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
QSTP key exchange functions. 

This header defines internal functions and state structures used for performing the key exchange in the Quantum Secure Tunneling Protocol (QSTP). The key exchange is a one-\/way process in which the client receives cryptographic parameters from the server that are used to establish a secure tunnel.

The key exchange mechanism in QSTP is responsible for\+:


\begin{DoxyItemize}
\item Verifying the server\textquotesingle{}s certificate serial number and public verification key.
\item Validating a session token hash to ensure the integrity of the key exchange.
\item Establishing an expiration time for the key exchange session.
\end{DoxyItemize}

The following state structures are defined\+:


\begin{DoxyItemize}
\item {\ttfamily \doxylink{structqstp__kex__client__state}{qstp\+\_\+kex\+\_\+client\+\_\+state}\+:} Used by the client during the key exchange, it stores the session token hash, the server certificate serial number, the server\textquotesingle{}s asymmetric signature verification key, and an expiration timestamp.
\item {\ttfamily \doxylink{structqstp__kex__server__state}{qstp\+\_\+kex\+\_\+server\+\_\+state}\+:} Used by the server during the key exchange, it holds pointers to the server\textquotesingle{}s private and public asymmetric cipher keys, a certificate serial number (serving as the key identity), a session token hash, the server\textquotesingle{}s private signing key, the local public verification key, and an expiration timestamp.
\end{DoxyItemize}

The following internal (non-\/exportable) functions are declared\+:


\begin{DoxyItemize}
\item {\ttfamily qstp\+\_\+kex\+\_\+server\+\_\+key\+\_\+exchange\+:} Executes the server-\/side operations of the key exchange by processing the client\textquotesingle{}s request, verifying the cryptographic parameters, and updating the connection state.
\item {\ttfamily qstp\+\_\+kex\+\_\+client\+\_\+key\+\_\+exchange\+:} Executes the client-\/side operations of the key exchange by processing the server\textquotesingle{}s response, extracting the cryptographic parameters, and ensuring the key exchange completes successfully.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
These functions and structures are internal to QSTP and are not part of the public API. 
\end{DoxyNote}


\doxysubsection{Function Documentation}
\Hypertarget{kex_8h_a21e7cf4bd346c4d534078be1757bde51}\index{kex.h@{kex.h}!qstp\_kex\_client\_key\_exchange@{qstp\_kex\_client\_key\_exchange}}
\index{qstp\_kex\_client\_key\_exchange@{qstp\_kex\_client\_key\_exchange}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qstp\_kex\_client\_key\_exchange()}{qstp\_kex\_client\_key\_exchange()}}
{\footnotesize\ttfamily \label{kex_8h_a21e7cf4bd346c4d534078be1757bde51} 
\mbox{\hyperlink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} qstp\+\_\+kex\+\_\+client\+\_\+key\+\_\+exchange (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqstp__kex__client__state}{qstp\+\_\+kex\+\_\+client\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{kcs}{, }\item[{\mbox{\hyperlink{structqstp__connection__state}{qstp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Run the network client version of the key exchange. 

This internal function executes the client-\/side key exchange. It processes the response from the server, extracts the session token hash, server certificate serial number, and the server\textquotesingle{}s public verification key, and verifies the expiration timestamp to ensure the key exchange is valid.

\begin{DoxyNote}{Note}
This is an internal non-\/exportable API.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em kcs} & A pointer to the client key exchange state structure ({\ttfamily \doxylink{structqstp__kex__client__state}{qstp\+\_\+kex\+\_\+client\+\_\+state}}). \\
\hline
{\em cns} & A pointer to the QSTP connection state structure.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} indicating the success or failure of the key exchange. 
\end{DoxyReturn}
\Hypertarget{kex_8h_a4c40b6b1bf97b19d057c5ce543dcc8e7}\index{kex.h@{kex.h}!qstp\_kex\_server\_key\_exchange@{qstp\_kex\_server\_key\_exchange}}
\index{qstp\_kex\_server\_key\_exchange@{qstp\_kex\_server\_key\_exchange}!kex.h@{kex.h}}
\doxysubsubsection{\texorpdfstring{qstp\_kex\_server\_key\_exchange()}{qstp\_kex\_server\_key\_exchange()}}
{\footnotesize\ttfamily \label{kex_8h_a4c40b6b1bf97b19d057c5ce543dcc8e7} 
\mbox{\hyperlink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} qstp\+\_\+kex\+\_\+server\+\_\+key\+\_\+exchange (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structqstp__kex__server__state}{qstp\+\_\+kex\+\_\+server\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{kss}{, }\item[{\mbox{\hyperlink{structqstp__connection__state}{qstp\+\_\+connection\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{cns}{}\end{DoxyParamCaption})}



Run the network server version of the key exchange. 

This internal function performs the server-\/side key exchange. It processes the client\textquotesingle{}s key exchange request by using the server key exchange state. The function validates the received session token hash, certificate serial number, and updates the QSTP connection state accordingly.

\begin{DoxyNote}{Note}
This is an internal non-\/exportable API.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em kss} & A pointer to the server key exchange state structure ({\ttfamily \doxylink{structqstp__kex__server__state}{qstp\+\_\+kex\+\_\+server\+\_\+state}}). \\
\hline
{\em cns} & A pointer to the QSTP connection state structure.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a value of type {\ttfamily \doxylink{qstp_8h_a79f518d89bcc513585dd80cce892d853}{qstp\+\_\+errors}} indicating the outcome of the key exchange. 
\end{DoxyReturn}
