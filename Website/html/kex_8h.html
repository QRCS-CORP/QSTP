<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Secure Tunneling Protocol: C:/Users/stepp/Documents/Visual Studio 2022/Projects/C/QSTP/QSTP/kex.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="qstp_extra_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Quantum Secure Tunneling Protocol<span id="projectnumber">&#160;1.0.0.0a (A1)</span>
   </div>
   <div id="projectbrief">A three-party quantum secure encrypted tunneling protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('kex_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">kex.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>QSTP key exchange functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="qstp_8h_source.html">../QSTP/qstp.h</a>&quot;</code><br />
</div>
<p><a href="kex_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqstp__kex__client__state.html">qstp_kex_client_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The QSTP client state structure.  <a href="structqstp__kex__client__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structqstp__kex__server__state.html">qstp_kex_server_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The QSTP server state structure.  <a href="structqstp__kex__server__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3f04acf418e78533b0e81fce4f38d99a" id="r_a3f04acf418e78533b0e81fce4f38d99a"><td class="memItemLeft" align="right" valign="top"><a id="a3f04acf418e78533b0e81fce4f38d99a" name="a3f04acf418e78533b0e81fce4f38d99a"></a>
typedef struct qstp_kex_client_state&#160;</td><td class="memItemRight" valign="bottom"><b>qstp_kex_client_state</b></td></tr>
<tr class="separator:a3f04acf418e78533b0e81fce4f38d99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a628f08680bc40241d868cee8176bcb4b" id="r_a628f08680bc40241d868cee8176bcb4b"><td class="memItemLeft" align="right" valign="top"><a id="a628f08680bc40241d868cee8176bcb4b" name="a628f08680bc40241d868cee8176bcb4b"></a>
typedef struct qstp_kex_server_state&#160;</td><td class="memItemRight" valign="bottom"><b>qstp_kex_server_state</b></td></tr>
<tr class="separator:a628f08680bc40241d868cee8176bcb4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4c40b6b1bf97b19d057c5ce543dcc8e7" id="r_a4c40b6b1bf97b19d057c5ce543dcc8e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853">qstp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c40b6b1bf97b19d057c5ce543dcc8e7">qstp_kex_server_key_exchange</a> (<a class="el" href="structqstp__kex__server__state.html">qstp_kex_server_state</a> *kss, <a class="el" href="structqstp__connection__state.html">qstp_connection_state</a> *cns)</td></tr>
<tr class="memdesc:a4c40b6b1bf97b19d057c5ce543dcc8e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the network server version of the key exchange.  <br /></td></tr>
<tr class="separator:a4c40b6b1bf97b19d057c5ce543dcc8e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e7cf4bd346c4d534078be1757bde51" id="r_a21e7cf4bd346c4d534078be1757bde51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853">qstp_errors</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21e7cf4bd346c4d534078be1757bde51">qstp_kex_client_key_exchange</a> (<a class="el" href="structqstp__kex__client__state.html">qstp_kex_client_state</a> *kcs, <a class="el" href="structqstp__connection__state.html">qstp_connection_state</a> *cns)</td></tr>
<tr class="memdesc:a21e7cf4bd346c4d534078be1757bde51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the network client version of the key exchange.  <br /></td></tr>
<tr class="separator:a21e7cf4bd346c4d534078be1757bde51"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>QSTP key exchange functions. </p>
<p>This header defines internal functions and state structures used for performing the key exchange in the Quantum Secure Tunneling Protocol (QSTP). The key exchange is a one-way process in which the client receives cryptographic parameters from the server that are used to establish a secure tunnel.</p>
<p>The key exchange mechanism in QSTP is responsible for:</p>
<ul>
<li>Verifying the server's certificate serial number and public verification key.</li>
<li>Validating a session token hash to ensure the integrity of the key exchange.</li>
<li>Establishing an expiration time for the key exchange session.</li>
</ul>
<p>The following state structures are defined:</p>
<ul>
<li><code><a class="el" href="structqstp__kex__client__state.html" title="The QSTP client state structure.">qstp_kex_client_state</a>:</code> Used by the client during the key exchange, it stores the session token hash, the server certificate serial number, the server's asymmetric signature verification key, and an expiration timestamp.</li>
<li><code><a class="el" href="structqstp__kex__server__state.html" title="The QSTP server state structure.">qstp_kex_server_state</a>:</code> Used by the server during the key exchange, it holds pointers to the server's private and public asymmetric cipher keys, a certificate serial number (serving as the key identity), a session token hash, the server's private signing key, the local public verification key, and an expiration timestamp.</li>
</ul>
<p>The following internal (non-exportable) functions are declared:</p>
<ul>
<li><code>qstp_kex_server_key_exchange:</code> Executes the server-side operations of the key exchange by processing the client's request, verifying the cryptographic parameters, and updating the connection state.</li>
<li><code>qstp_kex_client_key_exchange:</code> Executes the client-side operations of the key exchange by processing the server's response, extracting the cryptographic parameters, and ensuring the key exchange completes successfully.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>These functions and structures are internal to QSTP and are not part of the public API. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a21e7cf4bd346c4d534078be1757bde51" name="a21e7cf4bd346c4d534078be1757bde51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e7cf4bd346c4d534078be1757bde51">&#9670;&#160;</a></span>qstp_kex_client_key_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853">qstp_errors</a> qstp_kex_client_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqstp__kex__client__state.html">qstp_kex_client_state</a> *</td>          <td class="paramname"><span class="paramname"><em>kcs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structqstp__connection__state.html">qstp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the network client version of the key exchange. </p>
<p>This internal function executes the client-side key exchange. It processes the response from the server, extracts the session token hash, server certificate serial number, and the server's public verification key, and verifies the expiration timestamp to ensure the key exchange is valid.</p>
<dl class="section note"><dt>Note</dt><dd>This is an internal non-exportable API.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kcs</td><td>A pointer to the client key exchange state structure (<code><a class="el" href="structqstp__kex__client__state.html" title="The QSTP client state structure.">qstp_kex_client_state</a></code>). </td></tr>
    <tr><td class="paramname">cns</td><td>A pointer to the QSTP connection state structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853" title="The QSTP error values.">qstp_errors</a></code> indicating the success or failure of the key exchange. </dd></dl>

</div>
</div>
<a id="a4c40b6b1bf97b19d057c5ce543dcc8e7" name="a4c40b6b1bf97b19d057c5ce543dcc8e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c40b6b1bf97b19d057c5ce543dcc8e7">&#9670;&#160;</a></span>qstp_kex_server_key_exchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853">qstp_errors</a> qstp_kex_server_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structqstp__kex__server__state.html">qstp_kex_server_state</a> *</td>          <td class="paramname"><span class="paramname"><em>kss</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structqstp__connection__state.html">qstp_connection_state</a> *</td>          <td class="paramname"><span class="paramname"><em>cns</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the network server version of the key exchange. </p>
<p>This internal function performs the server-side key exchange. It processes the client's key exchange request by using the server key exchange state. The function validates the received session token hash, certificate serial number, and updates the QSTP connection state accordingly.</p>
<dl class="section note"><dt>Note</dt><dd>This is an internal non-exportable API.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kss</td><td>A pointer to the server key exchange state structure (<code><a class="el" href="structqstp__kex__server__state.html" title="The QSTP server state structure.">qstp_kex_server_state</a></code>). </td></tr>
    <tr><td class="paramname">cns</td><td>A pointer to the QSTP connection state structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a value of type <code><a class="el" href="qstp_8h.html#a79f518d89bcc513585dd80cce892d853" title="The QSTP error values.">qstp_errors</a></code> indicating the outcome of the key exchange. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5a7a8ad7fd52b2a05665dc92ffe673dd.html">QSTP</a></li><li class="navelem"><a class="el" href="kex_8h.html">kex.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
